{"version":3,"file":"index.js","sources":["../src/js/consts.js","../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  form: document.querySelector('.js-search-form'),\n  gallery: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.js-loadMore-btn'),\n};\n\nconst photosParams = {\n  page: 1,\n  perPage: 15,\n  maxPage: 1,\n};\n\nconst KEY = '49310743-65b3f3ce2dd3324f0da11ae2e';\nconst ACTIVE_CLASS = 'active';\nconst HIDDEN_CLASS = 'is-hidden';\n\nconst lightbox = new SimpleLightbox('.js-gallery a', {\n  captionsData: 'alt', // Use the alt attribute of images for captions\n  captionDelay: 250, // Delay in milliseconds before showing the caption\n});\n\nexport { refs, KEY, ACTIVE_CLASS, HIDDEN_CLASS, photosParams, lightbox };\n","function createCardsMarkup(photos) {\n  return photos\n    .map(\n      photo =>\n        `<li class=\"gallery-item\">\n              <a href=\"${photo.largeImageURL}\"><img class=\"gallery-img\" src=\"${photo.webformatURL}\" alt=\"${photo.tags}\"/></a>\n              <ul class=\"gallery-item-desc\">\n                <li>\n                  <h3>Likes</h3>\n                  <p>${photo.likes}</p>\n                </li>\n                <li>\n                  <h3>Views</h3>\n                  <p>${photo.views}</p>\n                </li>\n                <li>\n                  <h3>Comments</h3>\n                  <p>${photo.comments}</p>\n                </li>\n                <li>\n                  <h3>Downloads</h3>\n                  <p>${photo.downloads}</p>\n                </li>\n              </ul>\n        </li>`\n    )\n    .join('');\n}\n\nexport { createCardsMarkup };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport {\n  refs,\n  KEY,\n  ACTIVE_CLASS,\n  HIDDEN_CLASS,\n  photosParams,\n  lightbox,\n} from './consts';\nimport { createCardsMarkup } from './render-functions';\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nasync function handlerForm(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n  refs.loadMoreBtn.classList.add(HIDDEN_CLASS);\n  photosParams.page = 1;\n  const query = form.elements.request.value.trim();\n\n  if (query === '') {\n    iziToast.show({\n      title: 'Error',\n      message: 'You entered an empty string',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  photosParams.q = query;\n  refs.loader.classList.add(ACTIVE_CLASS);\n  try {\n    const photos = await getPhotos(photosParams);\n    refs.loader.classList.remove(ACTIVE_CLASS);\n    if (photos.total === 0) {\n      iziToast.show({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      refs.gallery.innerHTML = '';\n      return;\n    }\n    photosParams.maxPage = Math.ceil(photos.totalHits / photosParams.perPage);\n    refs.gallery.innerHTML = createCardsMarkup(photos.hits);\n\n    lightbox.refresh();\n\n    if (photosParams.maxPage !== 1) {\n      refs.loadMoreBtn.classList.remove(HIDDEN_CLASS);\n      refs.loadMoreBtn.addEventListener('click', handleLoadMore);\n    }\n  } catch (err) {\n    refs.loader.classList.remove(ACTIVE_CLASS);\n    console.log(err);\n  } finally {\n    form.reset();\n  }\n}\n\nasync function handleLoadMore(event) {\n  refs.loadMoreBtn.disabled = true;\n  refs.loader.classList.add(ACTIVE_CLASS);\n  photosParams.page += 1;\n  try {\n    const photos = await getPhotos(photosParams);\n    refs.loader.classList.remove(ACTIVE_CLASS);\n    refs.gallery.insertAdjacentHTML(\n      'beforeend',\n      createCardsMarkup(photos.hits)\n    );\n    const cardHeight = refs.gallery\n      .querySelector('li')\n      .getBoundingClientRect().height;\n    window.scrollBy({ top: cardHeight * 2, left: 0, behavior: 'smooth' });\n    lightbox.refresh();\n    refs.loadMoreBtn.disabled = false;\n    if (photosParams.page >= photosParams.maxPage) {\n      refs.loadMoreBtn.classList.add(HIDDEN_CLASS);\n      refs.loadMoreBtn.removeEventListener('click', handleLoadMore);\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  } catch (err) {\n    console.log(err);\n    refs.loader.classList.remove(ACTIVE_CLASS);\n  }\n}\n\nasync function getPhotos({ q, page = 1, perPage = 15 }) {\n  const res = await axios.get('api/', {\n    params: { key: KEY, q, page, per_page: perPage },\n  });\n  return res.data;\n}\n\nexport { handlerForm };\n","import { handlerForm } from './js/pixabay-api';\nimport { refs } from './js/consts';\n\nrefs.form.addEventListener('submit', handlerForm);\n"],"names":["refs","photosParams","KEY","ACTIVE_CLASS","HIDDEN_CLASS","lightbox","SimpleLightbox","createCardsMarkup","photos","photo","axios","handlerForm","event","form","query","iziToast","getPhotos","handleLoadMore","err","cardHeight","q","page","perPage"],"mappings":"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"}